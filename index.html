<!DOCTYPE html>
<html class="scroll-smooth">
<head>
  <meta charset="utf-8">
  <meta name="description" content="DAComp: Benchmarking Data Agents across the Full Data Intelligence Lifecycle">
  <meta name="keywords" content="Data Agents, Data Engineering, Data Analysis, LLM, Benchmark">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>DAComp: Benchmarking Data Agents</title>

  <link rel="icon" href="./images/dacomp_logo.png">

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

  <style>
    /* --- Global & Utility --- */
    body { font-family: 'Noto Sans', sans-serif; background-color: #fff; padding-top: 3.25rem; }
    .title { font-family: 'Google Sans', sans-serif; }
    .scroll-smooth { scroll-behavior: smooth; }
    
    /* --- Navbar --- */
    .navbar { box-shadow: 0 1px 3px rgba(0,0,0,0.05); border-bottom: 1px solid #eee; }
    .navbar-brand { padding-left: 20px; align-items: center; display: flex; }
    .navbar-logo-img { max-height: 2.0rem; border-radius: 50%; margin-right: 8px; }
    .navbar-title { font-weight: 700; font-size: 1.3rem; color: #333; font-family: 'Google Sans', sans-serif; }
    .navbar-menu { padding-right: 20px; }

    /* --- Hero & Header --- */
    .publication-title { font-size: 2.8rem; font-weight: 700; line-height: 1.2; margin-bottom: 1rem; }
    .publication-authors { font-size: 1.25rem; color: #4a4a4a; }
    .button.is-dark { background-color: #363636; border-color: transparent; color: #fff; transition: all 0.2s; }
    .button.is-dark:hover { background-color: #292929; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }

    /* --- Animations --- */
    .animate-box { opacity: 0; transform: translateY(20px); transition: all 0.8s ease-out; }
    .animate-box.is-visible { opacity: 1; transform: translateY(0); }
    
    /* Hover Effects */
    .hover-shadow { transition: box-shadow 0.3s; }
    .hover-shadow:hover { box-shadow: 0 10px 20px rgba(0,0,0,0.15) !important; }
    
    .hover-scale { transition: transform 0.3s; display: block; }
    .hover-scale:hover { transform: scale(1.02); }

    /* --- Advanced Leaderboard Styles --- */
    .leaderboard-container { background: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); padding: 25px; position: relative; }
    
    /* Language Switcher (Top Right) */
    .lang-switch { 
      display: flex; justify-content: flex-end; margin-bottom: 15px; 
    }
    .lang-btn {
      border: 1px solid #dbdbdb; background: #fff; padding: 5px 12px; font-size: 0.85rem; cursor: pointer;
      transition: all 0.2s;
    }
    .lang-btn:first-child { border-radius: 4px 0 0 4px; border-right: none; }
    .lang-btn:last-child { border-radius: 0 4px 4px 0; }
    .lang-btn:hover { background: #f5f5f5; }
    .lang-btn.is-active { background: #363636; color: white; border-color: #363636; }

    /* Custom Tabs Colors */
    .tabs.is-toggle li.is-active a { color: #fff; border-color: transparent; }
    /* Define distinct colors for each task tab */
    .tabs.is-toggle.custom-tabs li.is-active#lb-tab-arch a { background-color: #8e44ad; } /* Purple */
    .tabs.is-toggle.custom-tabs li.is-active#lb-tab-impl a { background-color: #2980b9; } /* Blue */
    .tabs.is-toggle.custom-tabs li.is-active#lb-tab-evol a { background-color: #d35400; } /* Orange */
    .tabs.is-toggle.custom-tabs li.is-active#lb-tab-da a   { background-color: #27ae60; } /* Green */

    /* Table Styles */
    .table th { vertical-align: middle; font-size: 0.9rem; white-space: nowrap; }
    .score-col { font-weight: 700; color: #333; background-color: #f9fbfc; border-left: 2px solid #eee; border-right: 2px solid #eee; }
    
    /* Badges */
    .rank-1 { background: #ffd700; color: #fff; padding: 2px 8px; border-radius: 10px; font-weight: bold; box-shadow: 0 2px 4px rgba(0,0,0,0.15); }
    .rank-2 { background: #c0c0c0; color: #fff; padding: 2px 8px; border-radius: 10px; font-weight: bold; }
    .rank-3 { background: #cd7f32; color: #fff; padding: 2px 8px; border-radius: 10px; font-weight: bold; }
    .tag-model-type { font-size: 0.7rem; padding: 0 6px; height: 1.6em; margin-left: 5px; }

    /* Visibility */
    .leaderboard-table-wrapper { display: none; animation: fadeIn 0.3s ease-in-out; }
    .leaderboard-table-wrapper.is-active { display: block; }

    /* --- Case Studies --- */
    .case-study-container { margin-top: 30px; min-height: 400px; }
    
    /* Sub-nav Pills */
    .sub-nav-container { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
    .sub-nav-btn { 
      border: 1px solid #dbdbdb; background: white; color: #363636; padding: 8px 16px; 
      border-radius: 20px; cursor: pointer; font-size: 0.9rem; transition: all 0.2s; display: flex; align-items: center; gap: 6px;
    }
    .sub-nav-btn:hover { background: #f5f5f5; border-color: #b5b5b5; transform: translateY(-1px); }
    .sub-nav-btn.is-active { background: #3273dc; color: white; border-color: #3273dc; box-shadow: 0 4px 10px rgba(50, 115, 220, 0.3); }

    /* DE Showcase Layout */
    .de-showcase { display: flex; gap: 20px; flex-wrap: wrap; }
    .de-video-box { flex: 1; min-width: 300px; background: #000; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
    .de-image-box { flex: 1; min-width: 300px; display: flex; align-items: center; justify-content: center; background: #f9f9f9; border-radius: 8px; padding: 10px; border: 1px solid #eee;}
    .de-grid-images { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 100%; } /* For multiple images */

    /* DA Report Simulation */
    .da-input-card { background: #f4f8fb; border-left: 5px solid #209cee; padding: 20px; margin-bottom: 25px; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
    .da-report-paper { 
      background: white; border: 1px solid #ddd; box-shadow: 0 5px 20px rgba(0,0,0,0.08); padding: 50px; 
      border-radius: 4px; font-family: 'Times New Roman', serif; line-height: 1.7; color: #2c3e50;
      position: relative;
    }
    /* Paper curl effect */
    .da-report-paper::after {
        content: ""; position: absolute; bottom: 15px; right: 10px; width: 50%; height: 20px; 
        box-shadow: 0 15px 10px rgba(0, 0, 0, 0.1); transform: rotate(-3deg); z-index: -1;
    }
    .da-report-paper h1 { font-size: 2rem; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
    .da-report-paper h2 { font-size: 1.4rem; font-weight: bold; color: #444; margin-top: 30px; margin-bottom: 10px; border-left: 4px solid #333; padding-left: 10px; }
    .report-chart { border: 1px solid #eee; border-radius: 4px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); width: 100%; max-width: 900px; margin: 14px auto; display: block; }

    /* Utility: Hidden/Active Logic */
    .leaderboard-table-wrapper, .case-content, .sub-case-content, .main-case-content { display: none; animation: fadeIn 0.4s ease-out; }
    .leaderboard-table-wrapper.is-active, .case-content.is-active, .sub-case-content.is-active, .main-case-content.is-active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }


    /* Mobile helper */
    @media screen and (max-width: 768px) {
      .is-mobile-reverse-stack { flex-direction: column; }
      .de-grid-images { grid-template-columns: 1fr; } /* Stack images on mobile */
    }

    /* --- Leaderboard Table Tweaks --- */

    /* 1. å¤–å±‚å®¹å™¨ï¼šå…è®¸æ¨ªå‘æ»šåŠ¨ */
    .leaderboard-table-wrapper {
      display: none;
      width: 100%;
      overflow-x: auto; /* å…³é”®ï¼šå†…å®¹è¶…å‡ºæ—¶æ˜¾ç¤ºæ¨ªå‘æ»šåŠ¨æ¡ */
      -webkit-overflow-scrolling: touch; /* è®©ç§»åŠ¨ç«¯æ»šåŠ¨æ›´é¡ºæ»‘ */
      padding-bottom: 5px; /* é˜²æ­¢æ»šåŠ¨æ¡æŒ¡ä½æœ€åä¸€è¡Œ */
    }

    /* 2. è¡¨æ ¼ï¼šè®¾ç½®æœ€å°å®½åº¦ï¼Œå¼ºåˆ¶æ’‘å¼€å®¹å™¨ */
    .leaderboard-table-wrapper table {
      width: 100%; 
      min-width: 800px; /* ã€å…³é”®ã€‘è®¾ç½®ä¸€ä¸ªè¶³å¤Ÿå®½çš„æœ€å°å€¼ã€‚å½“å±å¹•å°äº800pxæ—¶ï¼Œå°±ä¼šå‡ºç°æ»šåŠ¨æ¡ */
      table-layout: auto; /* è®©åˆ—å®½æ ¹æ®å†…å®¹è‡ªé€‚åº”ï¼Œæˆ–è€…ç”¨ fixed ä¹Ÿå¯ä»¥ */
    }

    /* 3. å•å…ƒæ ¼ï¼šå¼ºåˆ¶ä¸æ¢è¡Œï¼Œå®Œæ•´æ˜¾ç¤ºå†…å®¹ */
    .leaderboard-table-wrapper table th,
    .leaderboard-table-wrapper table td {
      text-align: center !important;
      vertical-align: middle !important;
      padding: 12px 15px !important; /* å¢åŠ å·¦å³é—´è·ï¼Œè®©è¡¨æ ¼æ›´å®½æ• */
      
      /* 4.æ ¸å¿ƒè®¾ç½®ï¼šä¸æ¢è¡Œï¼Œä¹Ÿä¸éšè— */
      white-space: nowrap !important; 
      overflow: visible !important;
      text-overflow: clip !important; /* ç§»é™¤çœç•¥å· */
    }

      /* 5. å¼ºåˆ¶è¡¨æ ¼æ’‘æ»¡å®¹å™¨ */
    .leaderboard-table-wrapper table {
      width: 100% !important;
      table-layout: fixed; /* å›ºå®šåˆ—å®½ç®—æ³•ï¼Œèƒ½è®©è¡¨æ ¼æ›´å‡åŒ€ */
    }



    /* --- Custom Width --- */
    /* è¦†ç›– Bulma é»˜è®¤çš„ 960pxï¼Œæ”¹ä¸º 1200px æˆ–æ›´å¤§ */
    .container.is-wide { 
      max-width: 1200px !important; 
    }
    
    /* é’ˆå¯¹è¶…å¤§å±å¹•ï¼Œå¦‚æœæ‚¨æƒ³æ›´å®½ï¼Œå¯ä»¥è§£å¼€ä¸‹é¢çš„æ³¨é‡Š */
    @media screen and (min-width: 1408px) {
      .container.is-wide { max-width: 1344px !important; }
    }
    /* é’ˆå¯¹å¹³æ¿/å°å±å¹•ï¼Œè‡ªåŠ¨å›é€€åˆ°æµå¼å¸ƒå±€ï¼Œé˜²æ­¢æº¢å‡º */
    @media screen and (max-width: 1450px) {
      .container.is-wide { max-width: 95% !important; width: auto; }
    }
  </style>
</head>
<body>

<nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="#">
      <img src="./images/dacomp_logo.png" class="navbar-logo-img" alt="DAComp">
      <span class="navbar-title">DAComp</span>
    </a>
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample">
      <span aria-hidden="true"></span><span aria-hidden="true"></span><span aria-hidden="true"></span>
    </a>
  </div>
  <div id="navbarBasicExample" class="navbar-menu">
    <div class="navbar-end">
      <a class="navbar-item" href="#">Overview</a>
      <a class="navbar-item" href="#case-studies">Case Studies</a> 
      <a class="navbar-item" href="#leaderboard">Leaderboard</a> 
      <a class="navbar-item" href="#analysis">Analysis</a>
      <a class="navbar-item" href="#BibTeX">BibTeX</a>
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://spider2-sql.github.io/" target="_blank">
            Spider 2.0
          </a>
          <a class="navbar-item" href="https://da-code-bench.github.io/" target="_blank">
            DA-Code
          </a>
          <!-- <hr class="navbar-divider">
          <a class="navbar-item" href="https://github.com/your-org" target="_blank">
            View All Projects
          </a> -->
        </div>
      </div>
      <div class="navbar-item">
        <div class="buttons">
          <a class="button is-dark is-small is-rounded" href="https://github.com/anonymous/DAComp">
            <span class="icon"><i class="fab fa-github"></i></span><span>Code</span>
          </a>
          <a class="button is-dark is-small is-rounded" href="https://arxiv.org/abs/XXXX.XXXXX">
            <span class="icon"><i class="fas fa-file-pdf"></i></span><span>Paper</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</nav>

<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop animate-box">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          
          <h1 class="title publication-title" style="margin-bottom: 20px;">
            DAComp: Benchmarking Data Agents across the Full Data Intelligence Lifecycle
          </h1>
          
          <div class="is-size-5 publication-authors">
            <span class="author-block">Fangyu Lei<sup>1,2,3*Â§</sup>,</span>
            <span class="author-block">Jinxiang Meng<sup>1,2*</sup>,</span>
            <span class="author-block">Yiming Huang<sup>5</sup>,</span>
            <span class="author-block">Junjie Zhao<sup>3</sup>,</span>
            <span class="author-block">Yitong Zhang<sup>6</sup>,</span>
            <br>
            <span class="author-block">Jianwen Luo<sup>1,2</sup>,</span>
            <span class="author-block">Xin Zou<sup>3</sup>,</span>
            <span class="author-block">Ruiyi Yang<sup>3</sup>,</span>
            <span class="author-block">Wenbo Shi<sup>3</sup>,</span>
            <span class="author-block">Yan Gao<sup>3</sup>,</span>
            <span class="author-block">Shizhu He<sup>1,2</sup>,</span>
            <br>
            <span class="author-block">Zuo Wang<sup>3</sup>,</span>
            <span class="author-block">Qian Liu<sup>4</sup>,</span>
            <span class="author-block">Yang Wang<sup>3</sup>,</span>
            <span class="author-block">Ke Wang<sup>3,â€ </sup>,</span>
            <span class="author-block">Jun Zhao<sup>1,2</sup>,</span>
            <span class="author-block">Kang Liu<sup>1,2,â€ </sup></span>
          </div>

          <div class="is-size-6 publication-authors" style="margin-top: 15px;">
            <span class="author-block"><sup>1</sup>Institute of Automation, CAS</span>&nbsp;&nbsp;
            <span class="author-block"><sup>2</sup>University of Chinese Academy of Sciences</span><br>
            <span class="author-block"><sup>3</sup>ByteDance Seed</span>&nbsp;&nbsp;
            <span class="author-block"><sup>4</sup>TikTok</span>&nbsp;&nbsp;
            <span class="author-block"><sup>5</sup>UC San Diego</span>&nbsp;&nbsp;
            <span class="author-block"><sup>6</sup>NUS</span>
          </div>

          <div class="is-size-7 publication-authors" style="margin-top: 10px; color: #666;">
            <span class="author-block"><sup>*</sup>Equal Contribution,</span>
            <span class="author-block"><sup>Â§</sup>Work done at ByteDance Seed,</span>
            <span class="author-block"><sup>â€ </sup>Corresponding authors</span>
          </div>

          <div class="column has-text-centered" style="margin-top: 20px;">
            <div class="publication-links">
              <span class="link-block">
                <a href="https://arxiv.org/abs/XXXX.XXXXX" class="button is-normal is-rounded is-dark">
                  <span class="icon"><i class="fas fa-file-pdf"></i></span><span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://github.com/anonymous/DAComp" class="button is-normal is-rounded is-dark">
                  <span class="icon"><i class="fab fa-github"></i></span><span>Code</span>
                </a>
              </span>
              <span class="link-block">
                <a href="#" class="button is-normal is-rounded is-dark">
                  <span class="icon"><i class="fas fa-database"></i></span><span>Data</span>
                </a>
              </span>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</section>

<section class="section hero is-light" id="overview">
  <!-- <div class="container is-max-desktop animate-box"> -->
  <div class="container is-wide animate-box">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Overview</h2>
        <div class="content has-text-justified">
          <p>
            Real-world enterprise data intelligence workflows encompass <b>data engineering (DE)</b> that turns raw sources into analytical-ready tables and <b>data analysis (DA)</b> that converts those tables into decision-oriented insights. We introduce <b>DAComp</b>, a benchmark of <b>236 tasks</b> that mirrors these complex workflows.
          </p>
          <p>
            <b>Data Engineering (DE)</b> tasks require repository-level engineering on industrial schemas, including designing and building multi-stage SQL pipelines. <b>Data Analysis (DA)</b> tasks pose open-ended business problems that demand strategic planning and insight synthesis. Our experiments reveal that even state-of-the-art agents falter, with DE success rates under 20% and DA scores averaging below 40%.
          </p>
        </div>
        <div class="publication-banner hover-shadow" style="margin-top: 30px; border-radius: 8px; overflow: hidden;">
          <figure class="image">
            <img src="./images/main.png" alt="DAComp Overview">
            <figcaption class="has-text-centered mt-3 is-size-6 has-text-grey p-2">
              <!-- <b>Figure 1:</b> DAComp evaluates agents on Repository-level Data Engineering (DE) and Open-ended Data Analysis (DA). -->
            </figcaption>
          </figure>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section" id="case-studies">
  <!-- <div class="container is-max-desktop animate-box"> -->
  <div class="container is-wide animate-box">
    <h2 class="title is-3 has-text-centered">ğŸ§© Case Studies</h2>
    <p class="subtitle has-text-centered is-size-6 has-text-grey">
      Explore how agents handle challenges across the Hard Axis (Engineering) and Soft Axis (Analysis).
    </p>

    <div class="tabs is-centered is-boxed is-toggle is-toggle-rounded" style="margin-top: 30px;">
      <ul>
        <li class="is-active" onclick="switchMainCase('de-case')" id="tab-case-de">
          <a><span class="icon"><i class="fas fa-cogs"></i></span><span><b>DE:</b> Repository Engineering</span></a>
        </li>
        <li onclick="switchMainCase('da-case')" id="tab-case-da">
          <a><span class="icon"><i class="fas fa-chart-line"></i></span><span><b>DA:</b> Insight Report</span></a>
        </li>
      </ul>
    </div>

    <div class="case-study-container">
      
      <div id="de-case" class="main-case-content is-active">
        <div class="sub-nav-container">
          <button class="sub-nav-btn is-active" onclick="switchDeSub('de-ex-1', this)">
            <i class="fas fa-code-branch"></i> Example 1: Pipeline Evolution
          </button>
          <button class="sub-nav-btn" onclick="switchDeSub('de-ex-2', this)">
            <i class="fas fa-database"></i> Example 2: Migration (Multi-Image)
          </button>
          <button class="sub-nav-btn" onclick="switchDeSub('de-ex-3', this)">
            <i class="fas fa-project-diagram"></i> Example 3: Architecture
          </button>
        </div>

        <div id="de-ex-1" class="sub-case-content is-active">
          <div class="content mb-4"><h4 class="title is-5">Scenario: Adding Cost Allocation Logic</h4><p>Agent modifies a dbt project to add logic to <code>fct_sales_pipeline</code> without breaking dependencies.</p></div>
          <div class="de-showcase">
            <div class="de-video-box hover-shadow">
              <video controls loop muted style="width:100%; height:100%; object-fit:cover;"><source src="./static/videos/agent_coding_demo.mp4" type="video/mp4"></video>
            </div>
            <div class="de-image-box hover-shadow">
              <img src="./static/images/figure14_pipeline_error.png" alt="Pipeline Error">
            </div>
          </div>
        </div>

        <div id="de-ex-2" class="sub-case-content">
          <div class="content mb-4"><h4 class="title is-5">Scenario: Legacy SQL to dbt Migration</h4><p>Refactoring raw SQL scripts into modular Staging and Marts models.</p></div>
          <div class="de-showcase">
            <div class="de-grid-images">
              <div class="de-image-box hover-shadow"><img src="./static/images/figure14_pipeline_error.png" alt="Before"></div>
              <div class="de-image-box hover-shadow"><img src="./static/images/figure14_pipeline_error.png" alt="After"></div>
            </div>
          </div>
        </div>

        <div id="de-ex-3" class="sub-case-content">
          <div class="content mb-4"><h4 class="title is-5">Scenario: Designing a Data Warehouse Architecture</h4><p>Creating a blueprint for a multi-layer data warehouse from business requirements.</p></div>
          <div class="de-showcase">
            <div class="de-image-box hover-shadow" style="width:100%">
              <img src="./static/images/figure14_pipeline_error.png" alt="Architecture Diagram">
            </div>
          </div>
        </div>
      </div>

      <div id="da-case" class="main-case-content" style="display:none;">
        <div class="sub-nav-container">
          <button class="sub-nav-btn is-active" onclick="switchDaSub('da-ex-dacomp-001', this)"><i class="fas fa-coins"></i> SME Credit Allocation</button>
          <button class="sub-nav-btn" onclick="switchDaSub('da-ex-dacomp-021', this)"><i class="fas fa-car-side"></i> Ride Peaks Analysis</button>
          <button class="sub-nav-btn" onclick="switchDaSub('da-ex-dacomp-057', this)"><i class="fas fa-bullhorn"></i> Ads Decay Risk</button>
          <button class="sub-nav-btn" onclick="switchDaSub('da-ex-dacomp-090', this)"><i class="fas fa-exclamation-triangle"></i> Payment Risk Alert</button>
        </div>

        <div id="da-ex-dacomp-001" class="sub-case-content is-active">
          <div class="da-input-card"><p><b>User Question:</b> Credit risk and RMB 100M allocation with churn-aware limits/rates across SME ratings.</p></div>
          <div class="da-report-paper hover-shadow">
            <h1>Executive summary</h1>
            <ul>
              <li>Deploy 100M RMB: A 70.97M @4.65%, B 13.32M @5.05%, C 15.70M @5.45%; D excluded. Offer 120.23M to land 100M after churn.</li>
              <li>Default ladder: A 0.00%, B 2.63%, C 5.88%, D 100%; revenue capacity and stability favor overweighting A.</li>
              <li>Expected net profit â‰ˆ 3.44M RMB (LGD 45%, PD observed).</li>
            </ul>
            <h2>Visual evidence</h2>
            <img class="report-chart" src="./case-reports/dacomp-001/default_rate_by_rating.png" alt="Default rate by rating">
            <img class="report-chart" src="./case-reports/dacomp-001/risk_scatter.png" alt="Dependency vs profit volatility">
            <img class="report-chart" src="./case-reports/dacomp-001/churn_vs_rate.png" alt="Churn vs interest rate">
            <h2>Data and method</h2>
            <ul>
              <li>Tables: company_info, sales_invoices, input_invoices, annual_rate_&_churn.</li>
              <li>Metrics: revenue capacity (avg monthly sales), profit CV, dependency HHI, default by rating, churn curve by rate.</li>
            </ul>
            <h2>Key insights</h2>
            <ol>
              <li>Default risk escalates sharply by rating; exclude D or fully collateralize.</li>
              <li>A-rated: strongest revenue and diversified supply chain â†’ prioritize exposure.</li>
              <li>Volatility and concentration amplify B/C risk â†’ penalize HHI >0.50 or CV >2.0 with tighter covenants.</li>
            </ol>
            <h2>Credit allocation rules</h2>
            <ul>
              <li>Limit = 30% Ã— Avg Monthly Sales Ã— rating factor (A1.20/B1.00/C0.70/D0) Ã— stability factor (by CV) Ã— dependency factor (HHI-based, floored 0.60).</li>
              <li>Rates: base A 4.65% / B 5.05% / C 5.45% with CV and HHI add-ons; churn-adjusted offers = deploy / (1 âˆ’ churn).</li>
            </ul>
            <p class="is-size-7 has-text-grey">Source: case-reports/dacomp-001/dacomp-001_gsb_ref_2.md</p>
          </div>
        </div>

        <div id="da-ex-dacomp-021" class="sub-case-content">
          <div class="da-input-card"><p><b>User Question:</b> Identify ride booking peaks/troughs in 2024, analyze cancellation and cost per km, and give operational actions.</p></div>
          <div class="da-report-paper hover-shadow">
            <h1>Uber Ride Booking Analysis: Peaks, Troughs & Actions</h1>
            <h2>Executive Summary</h2>
            <p>150k rides (2024-01-01 to 09-09) show a 4.5x peak-to-trough swing (18:00 vs 23:00) with stable ~25% cancellation.</p>
            <h2>Hourly and daily patterns</h2>
            <img class="report-chart" src="./case-reports/dacomp-021/hourly_booking_patterns.png" alt="Hourly booking patterns">
            <p>Peak 18:00 (12,397 bookings); trough 23:00 (2,762). Business: supply-demand imbalance.</p>
            <img class="report-chart" src="./case-reports/dacomp-021/daily_booking_patterns.png" alt="Daily booking patterns">
            <p>Peak day Nov 16 (306) vs trough May 2 (198). Weekend cost/km higher (43+) vs weekday (28-30).</p>
            <h2>Vehicle performance</h2>
            <img class="report-chart" src="./case-reports/dacomp-021/comprehensive_analysis.png" alt="Vehicle and status breakdown">
            <p>Auto/Go Mini dominate share; completion 61-63% across vehicle types; cancellations stable across hours.</p>
            <h2>Operational recommendations</h2>
            <ul>
              <li>Dynamic driver allocation: pre-position +40% for 17:00-19:00; trim 23:00-05:00.</li>
              <li>Surge tuning: stronger 18:00-20:00 multipliers; keep weekday base steady, lean into weekend premium.</li>
              <li>Cancellation management: predictive flags, better ETA accuracy, proactive alternatives.</li>
              <li>Vehicle mix: raise Auto/Go Mini during peaks; reserve premium for weekend/high-value slots.</li>
            </ul>
            <p class="is-size-7 has-text-grey">Source: case-reports/dacomp-021/dacomp-021_gsb_ref_3.md</p>
          </div>
        </div>

        <div id="da-ex-dacomp-057" class="sub-case-content">
          <div class="da-input-card"><p><b>User Question:</b> Find >120-day campaigns with CAC +25% and LTV/CAC -20% last 30 days; analyze decay by lifecycle/channel/maturity and recommend fixes.</p></div>
          <div class="da-report-paper hover-shadow">
            <h1>Customer Acquisition Efficiency Decay (Google Ads)</h1>
            <h2>Data and scope</h2>
            <ul>
              <li>Tables: google_ads__campaign_report, google_ads__customer_acquisition_analysis.</li>
              <li>Window: 2024-01-03 to 2024-12-31; runtime >120 days; decay if CAC growth >25% and LTV/CAC change < -20%.</li>
            </ul>
            <h2>Flagged set</h2>
            <ul>
              <li>10 campaigns (High 8, Medium 2); avg CAC growth +176.7%, avg LTV/CAC change -93.5%; composite risk mean 0.778.</li>
              <li>Examples: CMP_ACC_FIN_001_008 (Shopping) CAC +636%, LTV/CAC -100%; CMP_ACC_GAME_001_008 (Video) CAC +72%, LTV/CAC -80.7%; etc.</li>
            </ul>
            <h2>Decay patterns</h2>
            <ul>
              <li>Channels: Video/Display show steep inflation and LTV/CAC collapse; Shopping also impacted.</li>
              <li>Lifecycle: Decline-stage worst; Unknown treated as Mature/Decline.</li>
              <li>Maturity: Mature accounts decaying â†’ audience exhaustion and saturation.</li>
            </ul>
            <img class="report-chart" src="./case-reports/dacomp-057/risk_heatmap_channel_lifecycle.png" alt="Risk heatmap by channel and lifecycle">
            <img class="report-chart" src="./case-reports/dacomp-057/high_risk_segment_distribution.png" alt="High-risk segment distribution">
            <h2>Recommendations</h2>
            <ul>
              <li>Budget triage: cut 20-35% from High-risk Video/Display with LTV/CAC <1; reallocate 15-25% to Growth/low-risk Search or stronger remarketing.</li>
              <li>Lifecycle resets: new creatives + exclusions for Video; tighter placements and value-based bidding for Display; feed/query sculpting for Shopping.</li>
              <li>Targeting: boost VIP/High Value B2B; suppress low-value cohorts; segment by intent/recency.</li>
              <li>Guardrails: weekly decay dashboard; pause if CAC growth >50% WoW with LTV/CAC <1.2; alerts when efficiency percentile <35 two weeks.</li>
            </ul>
            <p class="is-size-7 has-text-grey">Source: case-reports/dacomp-057/dacomp-057_gsb_ref_1.md</p>
          </div>
        </div>

        <div id="da-ex-dacomp-090" class="sub-case-content">
          <div class="da-input-card"><p><b>User Question:</b> Filter payment_rate_percentage <75% and outstanding_balance >15,000; score risk, profit share, 12-month collection trend, distribution vs normal, 6-month warning, and tiered controls.</p></div>
          <div class="da-report-paper hover-shadow">
            <h1>Customer Payment Risk Deep-Dive</h1>
            <h2>Executive summary</h2>
            <ul>
              <li>High-risk cohort: 399 customers; avg risk score 53.65 (top >70).</li>
              <li>Profit impact: 13.81% of total gross profit loss (cohort -$345.46M vs total -$2.50B).</li>
              <li>Collections: 3-month deterioration, -5.78 pp; 12-month change -1.35 pp.</li>
              <li>6-month warning: base/worst-case show $0 shortfall in provided forecasts (risk_adjusted_inflows == forecasted_inflows).</li>
            </ul>
            <div class="stat-block">
              <p><strong>Key metrics</strong></p>
              <ul>
                <li>Filter: payment_rate_percentage <75% AND outstanding_balance >15,000.</li>
                <li>Risk Score = (100 - payment_rate_percentage) Ã—0.4 + ((850 - credit_score)/850Ã—100) Ã—0.4 + (100 - business_stability_score) Ã—0.2.</li>
                <li>Median lifespan 894 vs 940 (normal); avg_invoice_amount 15,714 vs 15,365.</li>
              </ul>
            </div>
            <h2>Visual evidence</h2>
            <img class="report-chart" src="./case-reports/dacomp-090/risk_collection_and_distribution.png" alt="Collection trend and distributions">
            <img class="report-chart" src="./case-reports/dacomp-090/cashflow_risk_scenarios.png" alt="Cashflow risk scenarios">
            <h2>Recommendations</h2>
            <ul>
              <li>Extreme (>=75): hold orders; require deposits/LoCs; shorten terms; enforce late fees; rapid outreach.</li>
              <li>High (60-75): reduce limits; autopay; early-pay discounts; weekly monitoring.</li>
              <li>Medium (45-60): proactive dunning; reminders; PO validation.</li>
              <li>Low (<45): maintain terms; loyalty incentives.</li>
              <li>Portfolio: prioritize collections by risk Ã— outstanding_balance; stress-test cash at -5%/-10%/-20% collection shocks.</li>
            </ul>
            <p class="is-size-7 has-text-grey">Source: case-reports/dacomp-090/dacomp-090_gsb_ref_1.md</p>
          </div>
        </div>
      </div>

    </div>
  </div>
</section>

<section class="section hero is-light" id="leaderboard">
  <div class="container is-wide animate-box">
    <h2 class="title is-3 has-text-centered">ğŸ† Leaderboard</h2>
    
    <div class="leaderboard-container hover-shadow">
      
      <div class="lang-switch">
        <span style="margin-right: 10px; display:flex; align-items:center; font-weight:bold; color:#666;">Dataset Language:</span>
        <button class="lang-btn is-active" onclick="switchLang('en')" id="btn-en">English</button>
        <button class="lang-btn" onclick="switchLang('zh')" id="btn-zh">Chinese</button>
      </div>

      <div class="tabs is-centered is-boxed is-toggle is-toggle-rounded custom-tabs">
        <ul>
          <li class="is-active" onclick="switchLbTab('arch')" id="lb-tab-arch">
            <a><span class="icon is-small"><i class="fas fa-sitemap"></i></span><span>DE: Architecture</span></a>
          </li>
          <li onclick="switchLbTab('impl')" id="lb-tab-impl">
            <a><span class="icon is-small"><i class="fas fa-code"></i></span><span>DE: Implementation</span></a>
          </li>
          <li onclick="switchLbTab('evol')" id="lb-tab-evol">
            <a><span class="icon is-small"><i class="fas fa-sync-alt"></i></span><span>DE: Evolution</span></a>
          </li>
          <li onclick="switchLbTab('da')" id="lb-tab-da">
            <a><span class="icon is-small"><i class="fas fa-chart-pie"></i></span><span>Data Analysis</span></a>
          </li>
        </ul>
      </div>

      <div id="table-arch" class="leaderboard-table-wrapper is-active">
        <table class="table is-fullwidth is-hoverable">
          <thead>
            <tr>
              <th width="5%">Rank</th><th>Model</th><th>Framework</th>
              <th class="has-text-centered score-col" style="background:#f3e5f5;">Architecture Score</th>
              <th>Type</th>
            </tr>
          </thead>
          <tbody class="content-en">
            <tr><td><span class="rank-1">1</span></td><td><b>GPT-5</b></td><td>OpenHands</td><td class="has-text-centered score-col">66.44</td><td><span class="tag is-dark is-light is-rounded tag-model-type">Proprietary</span></td></tr>
            <tr><td><span class="rank-2">2</span></td><td><b>o3</b></td><td>OpenHands</td><td class="has-text-centered score-col">64.55</td><td><span class="tag is-dark is-light is-rounded tag-model-type">Proprietary</span></td></tr>
            <tr><td><span class="rank-3">3</span></td><td>Claude-4-Sonnet</td><td>OpenHands</td><td class="has-text-centered score-col">63.70</td><td><span class="tag is-dark is-light is-rounded tag-model-type">Proprietary</span></td></tr>
            <tr><td>4</td><td>DeepSeek-V3.1</td><td>OpenHands</td><td class="has-text-centered score-col">58.05</td><td><span class="tag is-info is-light is-rounded tag-model-type">Open</span></td></tr>
            <tr><td>5</td><td>Gemini-2.5-Pro</td><td>OpenHands</td><td class="has-text-centered score-col">55.82</td><td><span class="tag is-dark is-light is-rounded tag-model-type">Proprietary</span></td></tr>
          </tbody>
          <tbody class="content-zh" style="display:none;">
            <tr><td><span class="rank-1">1</span></td><td><b>GPT-5</b></td><td>OpenHands</td><td class="has-text-centered score-col">61.44</td><td><span class="tag is-dark is-light is-rounded tag-model-type">Proprietary</span></td></tr>
            <tr><td><span class="rank-2">2</span></td><td><b>o3</b></td><td>OpenHands</td><td class="has-text-centered score-col">54.77</td><td><span class="tag is-dark is-light is-rounded tag-model-type">Proprietary</span></td></tr>
            <tr><td><span class="rank-3">3</span></td><td>DeepSeek-V3.1</td><td>OpenHands</td><td class="has-text-centered score-col">53.54</td><td><span class="tag is-info is-light is-rounded tag-model-type">Open</span></td></tr>
            <tr><td>4</td><td>Qwen3-Coder</td><td>OpenHands</td><td class="has-text-centered score-col">52.07</td><td><span class="tag is-info is-light is-rounded tag-model-type">Open</span></td></tr>
            <tr><td>5</td><td>Gemini-2.5-Pro</td><td>OpenHands</td><td class="has-text-centered score-col">51.22</td><td><span class="tag is-dark is-light is-rounded tag-model-type">Proprietary</span></td></tr>
          </tbody>
        </table>
      </div>

      <div id="table-impl" class="leaderboard-table-wrapper">
        <table class="table is-fullwidth is-hoverable">
          <thead>
            <tr>
              <th width="5%">Rank</th><th>Model</th><th>Framework</th>
              <th class="has-text-centered score-col" style="background:#e3f2fd;">CFS Score</th>
              <th class="has-text-centered">Success Rate (SR)</th>
              <th>Type</th>
            </tr>
          </thead>
          <tbody class="content-en">
            <tr><td><span class="rank-1">1</span></td><td><b>GPT-5</b></td><td>OpenHands</td><td class="has-text-centered score-col">51.38</td><td class="has-text-centered">22.22%</td><td><span class="tag is-dark is-light tag-model-type">Proprietary</span></td></tr>
            <tr><td><span class="rank-2">2</span></td><td><b>Qwen3-Coder</b></td><td>OpenHands</td><td class="has-text-centered score-col">50.66</td><td class="has-text-centered">5.56%</td><td><span class="tag is-info is-light tag-model-type">Open</span></td></tr>
            <tr><td><span class="rank-3">3</span></td><td>o3</td><td>OpenHands</td><td class="has-text-centered score-col">50.17</td><td class="has-text-centered">38.89%</td><td><span class="tag is-dark is-light tag-model-type">Proprietary</span></td></tr>
            <tr><td>4</td><td>Claude-4-Sonnet</td><td>OpenHands</td><td class="has-text-centered score-col">48.02</td><td class="has-text-centered">19.44%</td><td><span class="tag is-dark is-light tag-model-type">Proprietary</span></td></tr>
            <tr><td>5</td><td>Gemini-2.5-Pro</td><td>OpenHands</td><td class="has-text-centered score-col">41.85</td><td class="has-text-centered">11.11%</td><td><span class="tag is-dark is-light tag-model-type">Proprietary</span></td></tr>
          </tbody>
          <tbody class="content-zh" style="display:none;">
            <tr><td><span class="rank-1">1</span></td><td><b>GPT-5</b></td><td>OpenHands</td><td class="has-text-centered score-col">33.74</td><td class="has-text-centered">--</td><td><span class="tag is-dark is-light tag-model-type">Proprietary</span></td></tr>
            <tr><td><span class="rank-2">2</span></td><td><b>Qwen3-Coder</b></td><td>OpenHands</td><td class="has-text-centered score-col">26.24</td><td class="has-text-centered">--</td><td><span class="tag is-info is-light tag-model-type">Open</span></td></tr>
            <tr><td><span class="rank-3">3</span></td><td>DeepSeek-V3.1</td><td>OpenHands</td><td class="has-text-centered score-col">14.31</td><td class="has-text-centered">--</td><td><span class="tag is-info is-light tag-model-type">Open</span></td></tr>
            <tr><td>4</td><td>Gemini-2.5-Pro</td><td>OpenHands</td><td class="has-text-centered score-col">9.68</td><td class="has-text-centered">--</td><td><span class="tag is-dark is-light tag-model-type">Proprietary</span></td></tr>
            <tr><td>5</td><td>o3</td><td>OpenHands</td><td class="has-text-centered score-col">3.97</td><td class="has-text-centered">--</td><td><span class="tag is-dark is-light tag-model-type">Proprietary</span></td></tr>
          </tbody>
        </table>
      </div>

      <div id="table-evol" class="leaderboard-table-wrapper">
        <table class="table is-fullwidth is-hoverable">
          <thead>
            <tr>
              <th width="5%">Rank</th><th>Model</th><th>Framework</th>
              <th class="has-text-centered score-col" style="background:#fbe9e7;">CFS Score</th>
              <th class="has-text-centered">Success Rate (SR)</th>
              <th>Type</th>
            </tr>
          </thead>
          <tbody class="content-en">
            <tr><td><span class="rank-1">1</span></td><td><b>o3</b></td><td>OpenHands</td><td class="has-text-centered score-col">30.78</td><td class="has-text-centered">13.16%</td><td><span class="tag is-dark is-light tag-model-type">Proprietary</span></td></tr>
            <tr><td><span class="rank-2">2</span></td><td><b>GPT-5</b></td><td>OpenHands</td><td class="has-text-centered score-col">28.87</td><td class="has-text-centered">14.47%</td><td><span class="tag is-dark is-light tag-model-type">Proprietary</span></td></tr>
            <tr><td><span class="rank-3">3</span></td><td>Qwen3-Coder</td><td>OpenHands</td><td class="has-text-centered score-col">28.65</td><td class="has-text-centered">6.25%</td><td><span class="tag is-info is-light tag-model-type">Open</span></td></tr>
            <tr><td>4</td><td>Claude-4-Sonnet</td><td>OpenHands</td><td class="has-text-centered score-col">28.34</td><td class="has-text-centered">11.84%</td><td><span class="tag is-dark is-light tag-model-type">Proprietary</span></td></tr>
            <tr><td>5</td><td>Gemini-2.5-Pro</td><td>OpenHands</td><td class="has-text-centered score-col">26.67</td><td class="has-text-centered">9.21%</td><td><span class="tag is-dark is-light tag-model-type">Proprietary</span></td></tr>
          </tbody>
          <tbody class="content-zh" style="display:none;">
            <tr><td><span class="rank-1">1</span></td><td><b>GPT-5</b></td><td>OpenHands</td><td class="has-text-centered score-col">36.77</td><td class="has-text-centered">20.00%</td><td><span class="tag is-dark is-light tag-model-type">Proprietary</span></td></tr>
            <tr><td><span class="rank-2">2</span></td><td><b>Qwen3-Coder</b></td><td>OpenHands</td><td class="has-text-centered score-col">25.89</td><td class="has-text-centered">12.00%</td><td><span class="tag is-info is-light tag-model-type">Open</span></td></tr>
            <tr><td><span class="rank-3">3</span></td><td>Gemini-2.5-Pro</td><td>OpenHands</td><td class="has-text-centered score-col">23.81</td><td class="has-text-centered">4.00%</td><td><span class="tag is-dark is-light tag-model-type">Proprietary</span></td></tr>
            <tr><td>4</td><td>o3</td><td>OpenHands</td><td class="has-text-centered score-col">23.14</td><td class="has-text-centered">6.00%</td><td><span class="tag is-dark is-light tag-model-type">Proprietary</span></td></tr>
            <tr><td>5</td><td>DeepSeek-V3.1</td><td>OpenHands</td><td class="has-text-centered score-col">22.32</td><td class="has-text-centered">8.00%</td><td><span class="tag is-info is-light tag-model-type">Open</span></td></tr>
          </tbody>
        </table>
      </div>

      <div id="table-da" class="leaderboard-table-wrapper">
        <table class="table is-fullwidth is-hoverable">
          <thead>
            <tr>
              <th width="5%">Rank</th>
              <th>Model</th>
              <th>Framework</th>
              <th class="has-text-centered score-col" style="background:#e8f5e9;">ğŸ“Š DA Score</th>
              <th>Type</th>
            </tr>
          </thead>
          <tbody class="content-en">
            <tr><td><span class="rank-1">1</span></td><td><b>GPT-5</b></td><td>OpenHands</td><td class="has-text-centered score-col">52.06</td><td><span class="tag is-dark is-light is-rounded tag-model-type">Proprietary</span></td></tr>
            <tr><td><span class="rank-2">2</span></td><td><b>Claude-4-Sonnet</b></td><td>OpenHands</td><td class="has-text-centered score-col">51.33</td><td><span class="tag is-dark is-light is-rounded tag-model-type">Proprietary</span></td></tr>
            <tr><td><span class="rank-3">3</span></td><td>o3</td><td>OpenHands</td><td class="has-text-centered score-col">48.78</td><td><span class="tag is-dark is-light is-rounded tag-model-type">Proprietary</span></td></tr>
            <tr><td>4</td><td>DeepSeek-V3.1</td><td>OpenHands</td><td class="has-text-centered score-col">45.79</td><td><span class="tag is-info is-light is-rounded tag-model-type">Open</span></td></tr>
            <tr><td>5</td><td>Qwen3-Coder</td><td>OpenHands</td><td class="has-text-centered score-col">41.88</td><td><span class="tag is-info is-light is-rounded tag-model-type">Open</span></td></tr>
          </tbody>
          <tbody class="content-zh" style="display:none;">
            <tr><td><span class="rank-1">1</span></td><td><b>GPT-5</b></td><td>OpenHands</td><td class="has-text-centered score-col">44.25</td><td><span class="tag is-dark is-light is-rounded tag-model-type">Proprietary</span></td></tr>
            <tr><td><span class="rank-2">2</span></td><td><b>o3</b></td><td>OpenHands</td><td class="has-text-centered score-col">40.11</td><td><span class="tag is-dark is-light is-rounded tag-model-type">Proprietary</span></td></tr>
            <tr><td><span class="rank-3">3</span></td><td>Gemini-2.5-Pro</td><td>OpenHands</td><td class="has-text-centered score-col">32.13</td><td><span class="tag is-dark is-light is-rounded tag-model-type">Proprietary</span></td></tr>
            <tr><td>4</td><td>DeepSeek-V3.1</td><td>OpenHands</td><td class="has-text-centered score-col">30.01</td><td><span class="tag is-info is-light is-rounded tag-model-type">Open</span></td></tr>
            <tr><td>5</td><td>Qwen3-Coder</td><td>OpenHands</td><td class="has-text-centered score-col">28.38</td><td><span class="tag is-info is-light is-rounded tag-model-type">Open</span></td></tr>
          </tbody>
        </table>
        <p class="help has-text-centered" style="margin-top: 10px; color: #888;">
          * [cite_start]DA Score is an aggregate metric assessing Accuracy, Insightfulness, and Completeness [cite: 108-109].
        </p>
      </div>

    </div>
  </div>
</section>

<section class="section" id="analysis">
  <div class="container is-max-desktop animate-box">
    <h2 class="title is-3 has-text-centered">Deep Dive Analysis</h2>
    <div class="columns is-vcentered">
      <div class="column is-6">
        <h3 class="title is-4">Detailed Error Analysis</h3>
        <div class="content">
          <p>We conducted a rigorous error analysis on Repository-level Data Engineering tasks. The results highlight that <b>Holistic Orchestration</b> is the primary bottleneck.</p>
          <ul>
            <li><b>Dependency Errors (68%):</b> Most failures occur due to broken lineage graphs between Staging, Core, and Marts layers.</li>
            <li><b>Calculation Logic (38%):</b> Semantic errors in metric definitions are common, especially in upstream layers.</li>
            <li><b>Capability Gap:</b> While GPT-5 performs well on planning, open-source models struggle significantly with "SQL Omission" in complex pipelines.</li>
          </ul>
        </div>
      </div>
      <div class="column is-6">
        <div class="vis-card hover-shadow">
          <img src="./static/images/average_error_sunburst_final_corrected.pdf" alt="Error Analysis Sunburst" style="width: 100%;">
          <p class="vis-caption">Fig 2. Average error distribution across 6 models on DE-Impl tasks.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content animate-box">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{lei2025dacomp,
  title={DAComp: Benchmarking Data Agents across the Full Data Intelligence Lifecycle},
  author={Lei, Fangyu and Meng, Jinxiang and Huang, Yiming and others},
  journal={arXiv preprint arXiv:XXXX.XXXXX},
  year={2025}
}</code></pre>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <p>This website is adapted from <a href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>. Licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
    </div>
  </div>
</footer>

<script>
  // --- Leaderboard Logic ---
  let currentLbTask = 'arch'; // Default task
  let currentLbLang = 'en';   // Default language

  // 1. Switch Task Tab
  function switchLbTab(tabName) {
    currentLbTask = tabName;
    
    // Reset Tabs UI
    document.querySelectorAll('.custom-tabs li').forEach(li => li.classList.remove('is-active'));
    document.getElementById('lb-tab-' + tabName).classList.add('is-active');

    // Show Table
    document.querySelectorAll('.leaderboard-table-wrapper').forEach(el => el.classList.remove('is-active'));
    document.getElementById('table-' + tabName).classList.add('is-active');
  }

  // 2. Switch Language
  function switchLang(lang) {
    currentLbLang = lang;

    // Reset Buttons UI
    document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('is-active'));
    document.getElementById('btn-' + lang).classList.add('is-active');

    // Toggle Table Content
    if (lang === 'en') {
      document.querySelectorAll('.content-en').forEach(el => el.style.display = '');
      document.querySelectorAll('.content-zh').forEach(el => el.style.display = 'none');
    } else {
      document.querySelectorAll('.content-en').forEach(el => el.style.display = 'none');
      document.querySelectorAll('.content-zh').forEach(el => el.style.display = '');
    }
  }

  // Initialize
  switchLbTab('arch');
  switchLang('en');

  // --- Case Study Logic ---
  function switchMainCase(caseId) {
    document.querySelectorAll('.main-case-content').forEach(el => { el.style.display = 'none'; el.classList.remove('is-active'); });
    const target = document.getElementById(caseId);
    target.style.display = 'block';
    setTimeout(() => target.classList.add('is-active'), 10);

    document.getElementById('tab-case-de').classList.remove('is-active');
    document.getElementById('tab-case-da').classList.remove('is-active');
    document.getElementById('tab-case-' + (caseId === 'de-case' ? 'de' : 'da')).classList.add('is-active');
  }

  function switchDeSub(subId, btnElement) {
    const parent = document.getElementById('de-case');
    parent.querySelectorAll('.sub-case-content').forEach(el => el.classList.remove('is-active'));
    document.getElementById(subId).classList.add('is-active');
    parent.querySelectorAll('.sub-nav-btn').forEach(btn => btn.classList.remove('is-active'));
    btnElement.classList.add('is-active');
  }

  function switchDaSub(subId, btnElement) {
    const parent = document.getElementById('da-case');
    parent.querySelectorAll('.sub-case-content').forEach(el => el.classList.remove('is-active'));
    document.getElementById(subId).classList.add('is-active');
    parent.querySelectorAll('.sub-nav-btn').forEach(btn => btn.classList.remove('is-active'));
    btnElement.classList.add('is-active');
  }

  // --- Navbar & Animation ---
  document.addEventListener('DOMContentLoaded', () => {
    // Mobile Burger
    const $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);
    if ($navbarBurgers.length > 0) {
      $navbarBurgers.forEach( el => {
        el.addEventListener('click', () => {
          const target = el.dataset.target;
          const $target = document.getElementById(target);
          el.classList.toggle('is-active');
          $target.classList.toggle('is-active');
        });
      });
    }

    // Scroll Animation (Fade-in Up)
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
        }
      });
    }, { threshold: 0.1 });

    document.querySelectorAll('.animate-box').forEach(el => observer.observe(el));
  });
</script>

</body>
</html>
